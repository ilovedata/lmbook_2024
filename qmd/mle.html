<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>부록 H — 지수군 분포 – 통계적 예측모형</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../qmd/aic.html" rel="next">
<link href="../qmd/quadratic.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-a08d9001fe0711adfabc365c1b400f34.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "일치 없음",
    "search-matching-documents-text": "일치된 문서",
    "search-copy-link-title": "검색 링크 복사",
    "search-hide-matches-text": "추가 검색 결과 숨기기",
    "search-more-match-text": "추가 검색결과",
    "search-more-matches-text": "추가 검색결과",
    "search-clear-button-title": "제거",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "취소",
    "search-submit-button-title": "검색",
    "search-label": "검색"
  }
}</script>
<script type="text/javascript">
 window.MathJax = {
  tex: {
    macros: {
    RR: '{\\mathbb R}',                    // a simple string replacement
    hatmat:'{\\pmb X ({\\pmb X}^t {\\pmb X} )^{-1} {\\pmb X}^t}',
    bold: ['\\boldsymbol{#1}',1] ,     // this macro has one parameter
    pardiff: ['\\frac{\\partial#2}{\\partial#1}', 2, 'x'], // this macro has an optional parameter that defaults to 'x'
    pardifftwo: ['\\frac{\\partial#1}{\\partial#2}', 2],
    pardiffd: ['\\frac{\\partial#1}{\\partial#2^t \\partial#2}', 2],
    pardiffdd: ['\\frac{\\partial#1}{\\partial#3 \\partial#2}', 3],
    norm: ['\\lVert#1\\rVert',1]
  },
  environments: {
  braced: ["\\left\\{", "\\right\\}"]
  }
 }
};
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../qmd/math_mat_basic.html">Appendices</a></li><li class="breadcrumb-item"><a href="../qmd/mle.html"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">지수군 분포</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="검색" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">통계적 예측모형</a> 
        <div class="sidebar-tools-main">
    <a href="../통계적-예측모형.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="검색"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/lse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">선형 회귀모형의 소개</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">선형회귀에서의 추론</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/inference2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">모형의 비교</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/modeleval2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">모형의 진단</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/residual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">관측값에 대한 진단</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/modelselection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">모형의 선택</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">분산분석 모형</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">공분산분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/compute.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">최소제곱 추정량의 계산</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/extension.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">회귀모형의 확장</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">일반화 선형모형</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/math_mat_basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">행렬의 기초</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/math_vector_space.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">벡터공간</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/math_eigen_value.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">고유값과 고유벡터</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/math_matrix_decomp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">행렬의 분해</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/math_vec_cal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">벡터 미분</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/multivar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">다변량 확률변수의 성질</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/quadratic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">이차형식과 제곱합의 분포</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/mle.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">지수군 분포</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/aic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">모형선택의 정보 기준</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/practice-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">R-실습: 중회귀 모형 적합</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/practice-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">R-실습: 중회귀 모형 진단</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/practice-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">R-실습: 관측값에 대한 진단</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/practice-04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">M</span>&nbsp; <span class="chapter-title">R-실습: 모형의 선택</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/practice-05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">N</span>&nbsp; <span class="chapter-title">R-실습: 분산분석 모형</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">목차</h2>
   
  <ul class="collapse">
  <li><a href="#가능도함수와-그-성질" id="toc-가능도함수와-그-성질" class="nav-link active" data-scroll-target="#가능도함수와-그-성질"><span class="header-section-number">H.1</span> 가능도함수와 그 성질</a></li>
  <li><a href="#독립표본" id="toc-독립표본" class="nav-link" data-scroll-target="#독립표본"><span class="header-section-number">H.2</span> 독립표본</a></li>
  <li><a href="#지수군-분포" id="toc-지수군-분포" class="nav-link" data-scroll-target="#지수군-분포"><span class="header-section-number">H.3</span> 지수군 분포</a></li>
  <li><a href="#최대가능도추정법" id="toc-최대가능도추정법" class="nav-link" data-scroll-target="#최대가능도추정법"><span class="header-section-number">H.4</span> 최대가능도추정법</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../qmd/math_mat_basic.html">Appendices</a></li><li class="breadcrumb-item"><a href="../qmd/mle.html"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">지수군 분포</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-expfamily" class="quarto-section-identifier">부록 H — 지수군 분포</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
주의
</div>
</div>
<div class="callout-body-container callout-body">
<p>이 장에서는 벡터와 스칼라의 표기를 구분없이 모두 보통체로 사용한다.</p>
</div>
</div>
<section id="가능도함수와-그-성질" class="level2" data-number="H.1">
<h2 data-number="H.1" class="anchored" data-anchor-id="가능도함수와-그-성질"><span class="header-section-number">H.1</span> 가능도함수와 그 성질</h2>
<p>확률변수 <span class="math inline">\(y\)</span> 가 확률밀도함수 <span class="math inline">\(f(y; \theta)\)</span>를 따른다고 하자. 모수벡터 <span class="math inline">\(\theta\)</span> 에 대한 가능도함수 <span class="math inline">\(L( \theta;y)\)</span>와 로그가능도함수 <span class="math inline">\(\ell( \theta;y)\)</span>는 다음과 같이 정의한다.</p>
<p><span class="math display">\[
L( \theta) = L( \theta;y) \equiv f(y; \theta), \quad \ell( \theta) = \ell( \theta;y) \equiv \log L( \theta;y)
\]</span></p>
<p>로그가능도함수를 모수 <span class="math inline">\(\theta\)</span>로 한 번 미분한 도함수(gradient)를 스코어함수(score function) <span class="math inline">\(s( \theta;y)\)</span> 로 아래와 같이 정의한다. 또한 두 번 미분한 헤시안(hessian)의 음수를 관측피셔정보(observed Fisher information) <span class="math inline">\(J( \theta;y)\)</span> 라고 정의한다.</p>
<p><span class="math display">\[  
s( \theta)  =  s( \theta;y) \equiv  \frac{\partial}{\partial  \theta } \ell (  \theta;y) ,\quad
J( \theta) =  J( \theta;y) \equiv  -\frac{\partial^2}{\partial { \theta}^2 } \ell (  \theta;y)   \]</span></p>
<p>위의 식에서 만약 모수벡터 <span class="math inline">\(\theta\)</span>의 차원이 <span class="math inline">\(p\)</span>라면 <span class="math inline">\(s( \theta)\)</span>는 <span class="math inline">\(p \times 1\)</span> 벡터이고 <span class="math inline">\(J( \theta;y)\)</span>는 <span class="math inline">\(p \times p\)</span>행렬이다.</p>
<p>로그가능도함수는 다음의 두 가지 중요한 방정식을 만족한다.</p>
<p><span id="eq-onedifflike"><span class="math display">\[
  E \left \{ \frac{\partial}{\partial  \theta } \ell (  \theta;y) \right \} =0
\tag{H.1}\]</span></span></p>
<p><span id="eq-twodifflike"><span class="math display">\[
E \left \{   \left [ \frac{\partial}{\partial  \theta } \ell (  \theta;y) \right ]
\left [ \frac{\partial}{\partial  \theta} \ell (  \theta;y)  \right ]^t \right\}
+ E \left \{ \frac{\partial^2}{\partial { \theta}^2 } \ell (  \theta;y) \right \}= 0
\tag{H.2}\]</span></span></p>
<p><a href="#eq-onedifflike" class="quarto-xref">식&nbsp;<span>H.1</span></a> 와 <a href="#eq-twodifflike" class="quarto-xref">식&nbsp;<span>H.2</span></a> 으로부터 다음과 같은 식이 유도되며</p>
<p><span class="math display">\[
E [ s( \theta;y)] =0, \quad E [ s( \theta;y)s^t( \theta;y)] =  E[ J( \theta;y)]  
\]</span></p>
<p>다음과 같은 공식이 주어진다.</p>
<p><span class="math display">\[
\begin{aligned}
Var[ s( \theta;y)] &amp; = E[ s( \theta;y){ s}^t( \theta;y)] - \{ E[ s( \theta;y)]E[ { s}^t( \theta;y)] \} \\
&amp; = E[ s( \theta;y){ s}^t( \theta;y)] -  0  \\
&amp; = -E \left [ \frac{\partial^2}{\partial { \theta}^2 } \log f(y; \theta) \right ] \\
&amp; = E[ J( \theta;y)] \\
&amp; \equiv  I( \theta)
\end{aligned}
\]</span></p>
<p>위의 식에서 스코어함수의 분산을 피셔정보(Fisher information)이라고 부르며 <span class="math inline">\(I( \theta)\)</span>로 표기한다.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
주의
</div>
</div>
<div class="callout-body-container callout-body">
<p>관측피셔정보(observed Fisher information) <span class="math inline">\(J( \theta;y)\)</span> 는 모수와 확률변수로 정의되는 확률 이며 피셔정보(Fisher information) <span class="math inline">\(I( \theta)\)</span>는 관측피셔정보의 기대값으로 모수만의 함수로서 더이상 확률변수가 아니다.</p>
</div>
</div>
<p>첫 번째 방정식 <a href="#eq-onedifflike" class="quarto-xref">식&nbsp;<span>H.1</span></a> 는 다음과 같이 적분과 미분의 교환에 의해 증명할 수 있다.</p>
<p><span class="math display">\[
\begin{aligned}
0 &amp;= \frac{\partial}{\partial  \theta }  \int  f(y; \theta)  ~ dy \\
&amp;= \int  \frac{\partial}{\partial  \theta } f(y; \theta)  ~ dy  \\
&amp;= \int   \frac{\frac{\partial}{\partial  \theta } f(y; \theta)}{f(y; \theta)} f(y; \theta)  ~ dy \\
&amp;= \int   \frac{\partial}{\partial  \theta } \ell ( \theta;y) f(y; \theta)  ~ dy \\
&amp;= E \left \{ \frac{\partial}{\partial  \theta } \ell ( \theta;y) \right \}
\end{aligned}
\]</span></p>
<p>두 번째 방정식 <a href="#eq-twodifflike" class="quarto-xref">식&nbsp;<span>H.2</span></a> 는 아래와 같이 증명할 수 있다.</p>
<p><span class="math display">\[
\begin{aligned}
0 &amp;= \frac{\partial}{\partial  \theta } \int   \frac{\partial}{\partial  \theta } \ell (  \theta;y) f(y; \theta)  ~dy \\
&amp; =  \int  \frac{\partial}{\partial  \theta } \left \{  f(y; \theta) \left [ \frac{\partial}{\partial  \theta } \ell (  \theta;y) \right ]^t \right \}  ~dy \\
&amp;=  \int \left \{  \left [ \frac{\partial}{\partial  \theta } f(y; \theta) \right ] \left [ \frac{\partial}{\partial  \theta } \ell ( \theta;y) \right ]^t  + f(y; \theta) \frac{\partial}{\partial  \theta } \left [ \frac{\partial}{\partial  \theta } \ell (  \theta;y) \right ]^t    \right \} ~dy \\
&amp;=  \int \left \{  \left [ \frac{\partial}{\partial  \theta } \ell ( \theta;y) \right ]  \left [ \frac{\partial}{\partial  \theta } \ell ( \theta;y) \right ]^t f(y; \theta) + \left [ \frac{\partial^2}{\partial { \theta}^2 } \ell ( \theta;y)  \right ] f(y; \theta)  \right \} ~dy \\
&amp;=  E \left \{ \left [ \frac{\partial}{\partial  \theta } \ell ( \theta;y) \right ]  \left [ \frac{\partial}{\partial  \theta } \ell ( \theta;y) \right ]^t \right \} +  E \left \{ \frac{\partial^2}{\partial { \theta}^2 } \ell ( \theta;y) \right \}
\end{aligned}
\]</span></p>
</section>
<section id="독립표본" class="level2" data-number="H.2">
<h2 data-number="H.2" class="anchored" data-anchor-id="독립표본"><span class="header-section-number">H.2</span> 독립표본</h2>
<p>표본 <span class="math inline">\(y_1,y_2,\dots,y_n\)</span> 가 분포 <span class="math inline">\(f(y ; { \theta})\)</span>에서 독립적으로 얻어졌다면 표본에 대한 가능도함수 <span class="math inline">\(L_n ( \theta)\)</span> 은 다음과 같다.</p>
<p><span id="eq-likesample"><span class="math display">\[
L_n( \theta) = \prod_{i=1}^n f(y_i; { \theta})
\tag{H.3}\]</span></span></p>
<p>또한 표본에 대한 로그가능도함수 <span class="math inline">\(\ell_n ( \theta)\)</span> 은 다음과 같다.</p>
<p><span id="eq-eqloglike"><span class="math display">\[
\ell_n( \theta) = \ell_n( \theta;  y)=\log L_n( \theta) = \log \prod_{i=1}^n f(y_i;  \theta) = \sum_{i=1}^n \log f(y_i;  \theta) = \sum_{i=1}^n \ell( \theta; y_i)
\tag{H.4}\]</span></span></p>
<p>표본에 의한 로그 가능도함수 <span class="math inline">\(\ell_n( \theta)\)</span>를 미분한 값, 즉 표본에 의한 스코어 함수 <span class="math inline">\(s_n( \theta)\)</span>는 다음과 같이 정의한다.</p>
<p><span class="math display">\[
s_n( \theta) = \pardifftwo{}{ \theta}\ell_n( \theta;  y )
\]</span></p>
<p><span class="math inline">\(n\)</span>개의 표본에 대한 관측피셔정보 <span class="math inline">\(J_n( \theta)\)</span>와 피셔정보 <span class="math inline">\(I_n( \theta)\)</span>도 한 개의 확률 변수 경우와 유사하게 다음과 같이 정의된다.</p>
<p><span class="math display">\[  
I_n( \theta) = E \left [  J_n( \theta;  y) \right ] = E \left [ -\pardiffdd{}{ \theta}{ \theta^t}\ell_n( \theta;  y )  \right ]
\]</span></p>
</section>
<section id="지수군-분포" class="level2" data-number="H.3">
<h2 data-number="H.3" class="anchored" data-anchor-id="지수군-분포"><span class="header-section-number">H.3</span> 지수군 분포</h2>
<p>확률변수 <span class="math inline">\(y\)</span>가 다음과 같은형태의 분포를 따른다면 <span class="math inline">\(y\)</span>의 분포는 지수군(exponential family)에 속한다고 한다.</p>
<p><span id="eq-expfam"><span class="math display">\[
f(y ;  \theta, \phi ) = \exp \left \{ \frac{ t (y)^t
  \xi ( \theta)-b( \theta)}{a(\phi) } + c(y,\phi) \right \}
\tag{H.5}\]</span></span></p>
<p>다시 쓰면</p>
<p><span class="math display">\[
\log f(y ;  \theta, \phi ) =  \frac{ t (y)^t
  \xi ( \theta)-b( \theta)}{a(\phi) } + c(y,\phi)
\]</span></p>
<p>지수군 분포 <a href="#eq-expfam" class="quarto-xref">식&nbsp;<span>H.5</span></a> 에서 <span class="math inline">\(t (y)^t = [ t_1 (y), \dots, t_k (y)]\)</span> 는 <span class="math inline">\(k\)</span> 개의 충분통계량으로 구성된 벡터이고 <span class="math inline">\(k\)</span>-차원 벡터 <span class="math inline">\(\xi ( \theta)^t  = [ \xi_1 ( \theta), \dots, \xi_k ( \theta) ]\)</span>를 <strong>기본형 모수</strong>(canonical parameter)라고 부른다. 또한 <span class="math inline">\(a(\phi)\)</span>를 <strong>스케일모수</strong>(scale parameter)라고 부르며 많은 경우 <span class="math inline">\(a(\phi) = a \times w\)</span> 의 형태로 나타나며 여기서 <span class="math inline">\(w\)</span>는 보통 가중치와 같은 역활을 한다. 또한 기본형 모수 <span class="math inline">\(\xi ( \theta)\)</span> 는 <span class="math inline">\(y\)</span> 의 평균 <span class="math inline">\(\mu=E(y)\)</span>와 특별한 함수관계를 가진다.</p>
<p>지수군 분포는 일반적으로 <a href="#eq-expfam" class="quarto-xref">식&nbsp;<span>H.5</span></a> 과 같은 나타낼 수 있으며 많은 경우 모수 <span class="math inline">\(\theta\)</span>와 기본형 모수 <span class="math inline">\(\xi ( \theta)\)</span>는 일대일 대응관계를 가진다. 일대일 대응 관계가 아닌 경우 이를 곡선형 지수군(curved exponential family)라고 부른다. 따라서 지수군 분포의 성질을 간결하게 유도하고 설명하기 위해서 다음과 같은 단순화된 형태의 식을 사용하는 것이 편리하다. 이후 모든 성질의 유도는 아래 <a href="#eq-expfam2" class="quarto-xref">식&nbsp;<span>H.6</span></a> 의 형태를 사용할 것이다.</p>
<p><span id="eq-expfam2"><span class="math display">\[
\log f(y ;  \theta, \phi ) =  \frac{ { t}^t  \theta - b( \theta)}{a(\phi) } + c(y,\phi)
\tag{H.6}\]</span></span></p>
<p>위의 <a href="#eq-expfam2" class="quarto-xref">식&nbsp;<span>H.6</span></a> 은 충분통계량 벡터를 <span class="math inline">\(t\)</span> 로 나타내고 대응하는 기본형 모수를 <span class="math inline">\(\theta\)</span>로 표시한 것이다. 또한 여기서 충분통계량 벡터 <span class="math inline">\(t\)</span>의 평균을 <span class="math inline">\(\mu\)</span>라고 하자.</p>
<p><span class="math display">\[ E( t) =  \mu \]</span></p>
<section id="평균-분산과-기본형-모수의-관계" class="level3" data-number="H.3.1">
<h3 data-number="H.3.1" class="anchored" data-anchor-id="평균-분산과-기본형-모수의-관계"><span class="header-section-number">H.3.1</span> 평균, 분산과 기본형 모수의 관계</h3>
<p>이제 <a href="#eq-expfam2" class="quarto-xref">식&nbsp;<span>H.6</span></a> 에 나오는 <span class="math inline">\(b( \theta)\)</span>의 미분을 다음과 같이 표시하자.</p>
<p><span class="math display">\[
b'(  \theta ) = \pardifftwo{b(  \theta)}{  \theta} , \quad b''(  \theta) = \pardifftwo{b( \theta)}{ \theta}
\]</span></p>
<p>방정식 <a href="#eq-onedifflike" class="quarto-xref">식&nbsp;<span>H.1</span></a> 으로부터 다음과 같은 식이 유도된다..</p>
<p><span class="math display">\[
\begin{aligned}
0 &amp; = E \left ( \pardifftwo{\ell }{  \theta } \right ) \\
   &amp; = E \left (   t-b'(  \theta) )/ a(\phi) \right ) \\
   &amp; = [  E(t) -b'( \theta) ] / a(\phi)  \\
   &amp; = [  \mu-b'( \theta) ] / a(\phi)
\end{aligned}
\]</span></p>
<p>따라서 평균 <span class="math inline">\(\mu\)</span>와 함수 <span class="math inline">\(b( \theta)\)</span>는 다음과 같은 관계가 성립한다.</p>
<p><span id="eq-diffmu"><span class="math display">\[
E( t) =  \mu = b'( \theta)
\tag{H.7}\]</span></span></p>
<p>또한 방정식 <a href="#eq-twodifflike" class="quarto-xref">식&nbsp;<span>H.2</span></a> 으로부터 다음이 성립하고</p>
<p><span class="math display">\[
E \left \{ a^{-2}(\phi)  [  t-b'(  \theta)][  t-b'( \theta)]^t   \right \} +  E \left \{ - a^{-1} (\phi)  b''( \theta)  \right \} =0
\]</span></p>
<p>따라서 <span class="math inline">\(t\)</span>의 분산과 함수 <span class="math inline">\(b(  \theta)\)</span>는 다음과 같은 관계가 성립한다.</p>
<p><span id="eq-varfunction"><span class="math display">\[
Var ( t) = a(\phi) b''(  \theta)  \equiv a(\phi) v(  \mu)  
\tag{H.8}\]</span></span></p>
<p>위의 식에서 <span class="math inline">\(v( \mu) = b''( \theta)\)</span> 으로 정의하고 분산함수(variance function)라고 부른다.</p>
<p>이제 분산함수의 정의로부터 <span class="math inline">\(\mu,  \theta\)</span>에 대하여 다음과 같은 관계가 얻어지고</p>
<p><span id="eq-onediffmu"><span class="math display">\[
\pardifftwo{  \mu}{  \theta } = \pardifftwo{b'(  \theta)}{  \theta } = b''( \theta)  =  v( \mu)
\tag{H.9}\]</span></span></p>
<p>도함수의 역관계가 다음과 같이 주어진다.</p>
<p><span id="eq-onediffmuinv"><span class="math display">\[
\frac{\partial  \theta}{\partial   \mu } =
\left [ \frac{\partial  \mu }{\partial   \theta} \right ]^{-1} =
\left [ b''(  \theta) \right ]^{-1} = v^{-1}( \mu)
\tag{H.10}\]</span></span></p>
</section>
<section id="지수군-분포의-예제" class="level3" data-number="H.3.2">
<h3 data-number="H.3.2" class="anchored" data-anchor-id="지수군-분포의-예제"><span class="header-section-number">H.3.2</span> 지수군 분포의 예제</h3>
<div id="exm-mle-binom" class="theorem example">
<p><span class="theorem-title"><strong>보기 H.1 (이항분포)</strong></span> 확률변수 <span class="math inline">\(S\)</span> 가 이항분포 <span class="math inline">\(B(n,\mu)\)</span>를 따른다면(여기서 <span class="math inline">\(\mu=p\)</span> 성공확률) 표본 비율 <span class="math inline">\(y=S/n\)</span>의 로그확률밀도함수는 다음과 같다.</p>
<p><span class="math display">\[
\begin{aligned}
\log f(y ; \theta, \phi ) &amp; = \log \left \{ \binom{n}{ny} \mu^{ny} (1-\mu)^{n-ny}  \right \} \\
&amp; =   \frac{ y \log \frac{\mu}{1-\mu} + \log (1-\mu)}{n^{-1}} + \log \binom{n}{ny} \\
&amp;= \frac{y\theta-b(\theta)}{a(\phi) } + c(y,\phi)
\end{aligned}
\]</span></p>
<p>충분통계량 <span class="math inline">\(t\)</span>는 표본비율 <span class="math inline">\(y\)</span>이고 기본형 모수 <span class="math inline">\(\theta\)</span>와 평균 <span class="math inline">\(E(y)=\mu=p\)</span>, 스케일 모수 <span class="math inline">\(a(\phi)\)</span>은 다음과 같은 관계가 있다.</p>
<p><span id="eq-logit"><span class="math display">\[
\theta  = \log \frac{\mu}{1-\mu}  = \log \frac{p}{1-p} , \quad b(\theta) = - \log(1-\mu), \quad  a(\phi) = \frac{1}{n}
\tag{H.11}\]</span></span><br>
평균 <span class="math inline">\(\mu\)</span>를 기본형모수 <span class="math inline">\(\theta\)</span>의 함수로 역변환하면 <span class="math inline">\(\theta\)</span>의 로지스틱함수로 표현된다.</p>
<p><span class="math display">\[
\mu = \frac{\exp(\theta)}{1+\exp(\theta)}=\frac{1}{1+\exp(-\theta)},
\quad 1-\mu = \frac{1}{1+\exp(\theta)}
\]</span></p>
<p>또한 함수 <span class="math inline">\(b(\theta)\)</span>를 기본형 모수로 나타내면</p>
<p><span class="math display">\[
b(\theta)  = - \log ( 1-\mu)  = \log [ 1+\exp(\theta)]
\]</span></p>
<p>특별히 <span class="math inline">\(n=1\)</span>인 경우는 베르누이 분포이다.</p>
<p>이항분포에서 평균 <span class="math inline">\(\mu\)</span>는 함수 <span class="math inline">\(b\)</span>와 다음과 같은 관계가 있다.</p>
<p><span class="math display">\[
b'(\theta) = \frac{\exp(\theta)}{1+\exp(\theta)} =\mu
\]</span></p>
<p>또한</p>
<p><span class="math display">\[
b''(\theta) = \frac{\exp(\theta)[1+\exp(\theta)] -[\exp(\theta)]^2 }{[1+\exp(\theta)]^2} =\mu(1-\mu) = v(\mu)
\]</span></p>
<p>따라서</p>
<p><span class="math display">\[
Var(y) = a(\phi) v(\mu) =\frac{\mu(1-\mu)}{n}
\]</span></p>
</div>
<div id="exm-mle-poisson" class="theorem example">
<p><span class="theorem-title"><strong>보기 H.2 (포아송분포)</strong></span> 확률변수 <span class="math inline">\(y\)</span> 가 포아송 분포 <span class="math inline">\(poi(\mu)\)</span>를 따른다고 하자. 여기서 <span class="math inline">\(E(y) = \mu\)</span> 이다. 확률변수 <span class="math inline">\(y\)</span>의 로그확률밀도함수는 다음과 같다.</p>
<p><span class="math display">\[  \log f(y ; \theta, \phi )  = y \log \mu -\mu - log(y!) \]</span></p>
<p>충분통계량 <span class="math inline">\(t\)</span>는 반응값 <span class="math inline">\(y\)</span> 자체이고 기본형 모수 <span class="math inline">\(\theta\)</span>와 평균 <span class="math inline">\(E(y)=\mu\)</span>, 스케일 모수 <span class="math inline">\(a(\phi)\)</span>은 다음과 같은 관계가 있다.기본형 모수 <span class="math inline">\(\theta\)</span>와 평균 <span class="math inline">\(\mu\)</span>, 스케일 모수 <span class="math inline">\(a(\phi)\)</span>은 다음과 같은 관계가 있다.</p>
<p><span class="math display">\[
\theta  = \log \mu , \quad b(\theta) =  \mu , \quad  a(\phi) = 1
\]</span></p>
<p>평균 <span class="math inline">\(\mu\)</span>를 기본형모수 <span class="math inline">\(\theta\)</span>의 함수로 역변환하면 <span class="math inline">\(\theta\)</span>의로그함수로 표현된다. 또한 함수 <span class="math inline">\(b(\theta)\)</span>를 기본형 모수로 나타내면 다음과 같다. <span class="math display">\[ \mu = \exp(\theta), \quad b(\theta)  = \mu =\exp(\theta) \]</span></p>
<p>따라서 포아송분포에서는 평균 <span class="math inline">\(\mu\)</span>는 함수 <span class="math inline">\(b\)</span>와 다음과 같은 관계가 있다.</p>
<p><span class="math display">\[
b'(\theta) = \exp(\theta) =\mu, \quad b''(\theta) = \exp(\theta) =\mu = v(\mu)
\]</span></p>
<p>따라서</p>
<p><span class="math display">\[
Var(y) = a(\phi) v(\mu) =\mu
\]</span></p>
</div>
<div id="exm-mle-normal" class="theorem example">
<p><span class="theorem-title"><strong>보기 H.3 (정규분포)</strong></span> 확률변수 <span class="math inline">\(y\)</span> 가 정규분포 <span class="math inline">\(N(\mu, \sigma^2)\)</span>를 따른다고 하자. 확률변수 <span class="math inline">\(y\)</span>의 로그확률밀도함수는 다음과 같다. 이때 모수벡터를 <span class="math inline">\({ \theta}^t =(\mu,\sigma^2)\)</span>이다.</p>
<p><span class="math display">\[
\begin{aligned}
\log f(y ;  \theta, \phi ) &amp; = -\frac{1}{2} \log (2 \pi)-\frac{1}{2} \log \sigma^2 -\frac { (y - \mu)^2 }{2\sigma^2} \\
   &amp;= -\frac{1}{2} \log (2 \pi)-\frac{1}{2} \log \sigma^2 -\frac { y^2 -2 y \mu + \mu^2 }{2\sigma^2} \\
   &amp; = \left [ y \frac{\mu}{\sigma^2} - y^2 \frac{1}{2\sigma^2} \right ] - \left [ \frac{1}{2} \log \sigma^2 + \frac{\mu^2}{2\sigma^2} \right ] -\frac{n}{2} \log (2 \pi)
\end{aligned}
\]</span></p>
<p>충분 통계량과 기본형 모수는 다음과 같다.</p>
<p><span class="math display">\[  
t(y)^t = ( y, y^2), \quad   \xi ( \theta)^t = \left ( \frac{\mu}{\sigma^2}, -\frac{1}{2\sigma^2} \right ), \quad a(\phi)=1
\]</span></p>
<p>또한</p>
<p><span class="math display">\[
b( \theta) = \frac{1}{2} \log \sigma^2 + \frac{\mu^2}{2\sigma^2}
\]</span></p>
</div>
</section>
</section>
<section id="최대가능도추정법" class="level2" data-number="H.4">
<h2 data-number="H.4" class="anchored" data-anchor-id="최대가능도추정법"><span class="header-section-number">H.4</span> 최대가능도추정법</h2>
<p>모수 <span class="math inline">\(\theta\)</span> 에 대한 최대가능도 추정량(Maximum Likelihood Estimator;MLE) <span class="math inline">\(\hat { \theta}\)</span>는 가능도 함수를 최대로 하는 값으로 정의된다.</p>
<p><span class="math display">\[ \hat { \theta}_{MLE} = \arg \max_{ \theta} L_n( \theta)  \]</span></p>
<p>많은 경우 가능도 함수를 최대화하는 값을 구하기 어려우므로 가능도 함수의 로그 함수, 즉 로그가능도함수를 최대로 하는 값으로 최대가능도 추정량을 구한다.</p>
<p><span class="math display">\[ \hat { \theta}_{MLE} = \arg \max_{ \theta} \ell_n( \theta)  \]</span></p>
<p>만약 로그가능도 함수가 모수 <span class="math inline">\(\theta\)</span>에 대하며 미분가능한 함수이면 최대가능도 추정량은 다음과 같은 방정식에 의하여 구할 수 있다.</p>
<p><span class="math display">\[ \pardifftwo{}{ \theta}\ell_n( \theta;  y ) = s_n( \theta)= 0  \]</span></p>
<p>최대가능도 추정량은 적당한 조건하에서 다음과 같은 점근적 성질(Asymptotical properties)을 가진다.</p>
<ul>
<li><span class="math inline">\(\hat { \theta}_{MLE}\)</span>는 모수의 참값 <span class="math inline">\(\theta_0\)</span>로 확률적 수렴한다.</li>
</ul>
<p><span class="math display">\[  \hat { \theta}_{MLE} \rightarrow_p  \theta_0 \quad \text{as } n
\rightarrow \infty \]</span></p>
<ul>
<li>최대가능도추정량 <span class="math inline">\(\hat { \theta}_{MLE}\)</span>는 점근적으로 정규분포를 따른다.</li>
</ul>
<p><span class="math display">\[ \hat { \theta}_{MLE} \sim_d  N( \theta_0,  I_n^{-1}( \theta_0)) \]</span></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "복사완료!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "복사완료!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../qmd/quadratic.html" class="pagination-link" aria-label="이차형식과 제곱합의 분포">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">이차형식과 제곱합의 분포</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../qmd/aic.html" class="pagination-link" aria-label="모형선택의 정보 기준">
        <span class="nav-page-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">모형선택의 정보 기준</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>